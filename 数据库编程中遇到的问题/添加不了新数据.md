##### 2023年5月10日18点35分

###### 问题：

成功链接到数据库，也可以打开数据表，但就是不能添加新数据，在执行过程中程序不会报错，但是没有添加结果。

###### 分析原因：

在cmd中可以添加，但是使用代码的方式就添加不了是怎么回事？

###### 原因：

**没有使用：数据库对象.commit()**

###### 文档解释：

在使用MySQL数据库时，`.commit()`方法用于提交事务。事务是指一系列数据库操作（例如插入、更新或删除数据），要么全部成功执行，要么全部回滚（取消）。`.commit()`方法用于将先前执行的操作永久保存到数据库中。

具体来说，当你调用`.commit()`方法时，以下操作将发生：

1. 所有在调用`.execute()`方法后进行的数据修改操作将被提交到数据库。

2. 数据库将对这些修改进行持久化处理，即将其写入磁盘以确保数据的持久保存。

3. 如果事务成功提交，那么数据修改将对其他数据库连接可见。

需要注意的是，`.commit()`方法只能在开启了事务的情况下使用。如果你没有显式地开启事务，那么每个操作都会自动成为一个独立的事务，并在执行完成后自动提交。如果你在执行多个相关操作时需要确保原子性，即要么全部成功，要么全部失败，那么你可以显式地开启一个事务，并在操作完成后调用`.commit()`方法提交事务。

另外，如果你对数据库进行了修改操作但没有调用`.commit()`方法进行提交，那么这些修改将不会被永久保存到数据库中。在这种情况下，如果你关闭了数据库连接或程序终止，那么未提交的修改将丢失。

因此，在向MySQL数据库添加数据时，确保在需要的时候调用`.commit()`方法来提交事务，以确保数据的持久保存。



###### 尝试：

1. 操作：在cmd中添加数据

   结果：添加成功

2. 操作：

   原本无法添加的代码：

   ```python
    if len(table_datas) == 1:
        # 添加数据
        try:
          print(f'====检测到数据库为空，为您添加数据====')
          go_to = 'INSERT INTO test(id, name, age) VALUES(3, "张三", 25);'
          cursor.execute(go_to)
          print('数据添加成功！')
        except Exception as e:
          print(f'数据添加失败! {e}')
   ```

   在添加了mysql.commit()后执行成功

   ```python
    if len(table_datas) == 1:
        # 添加数据
        try:
          print(f'====检测到数据库为空，为您添加数据====')
          go_to = 'INSERT INTO test(id, name, age) VALUES(3, "张三", 25);'
          cursor.execute(go_to)
          mysql.commit()
          print('数据添加成功！')
        except Exception as e:
          print(f'数据添加失败! {e}')
   ```

   结果：添加成功